<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>机密投票系统 - FHEVM DApp</title>
    <link rel="stylesheet" href="frontend/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- 头部 -->
        <header class="header">
            <div class="logo">
                <h1>🔐 机密投票系统</h1>
                <p>基于 FHEVM 的隐私保护投票平台</p>
            </div>
            <div class="zama-badge">
                <span>🏆 Zama Builder 项目</span>
            </div>
        </header>

        <!-- 钱包连接区域 -->
        <div class="wallet-section">
            <button id="connectWallet" class="btn btn-primary">连接钱包</button>
            <div id="walletInfo" class="wallet-info">
                <p><strong>账户:</strong> <span id="accountAddress">未连接</span></p>
                <p><strong>网络:</strong> <span id="networkName">未连接</span></p>
                <p><strong>余额:</strong> <span id="accountBalance">0 ETH</span></p>
            </div>
        </div>

        <!-- 主要功能区域 -->
        <main class="main-content">
            <!-- 创建投票面板 -->
            <section class="admin-panel" id="adminPanel">
                <h2>📋 创建投票会话</h2>
                <div class="form-group">
                    <label for="sessionTitle">投票标题:</label>
                    <input type="text" id="sessionTitle" placeholder="输入投票标题">
                </div>
                <div class="form-group">
                    <label for="sessionDescription">投票描述:</label>
                    <textarea id="sessionDescription" placeholder="输入投票描述"></textarea>
                </div>
                <div class="form-group">
                    <label for="sessionDuration">持续时间（小时）:</label>
                    <input type="number" id="sessionDuration" min="1" max="168" value="24">
                </div>
                <div class="form-group">
                    <label for="sessionOptions">投票选项（每行一个）:</label>
                    <textarea id="sessionOptions" placeholder="选项A&#10;选项B&#10;选项C"></textarea>
                </div>
                <button id="createSession" class="btn btn-success">创建投票会话</button>
            </section>

            <!-- 投票会话列表 -->
            <section class="sessions-list">
                <h2>🗳️ 投票会话</h2>
                <div id="sessionsList" class="sessions-container">
                    <!-- 动态加载投票会话 -->
                </div>
                <button id="refreshSessions" class="btn btn-secondary">刷新列表</button>
            </section>

            <!-- 投票区域 -->
            <section class="voting-section" id="votingSection">
                <h2>🔐 进行投票</h2>
                <div id="currentSession" class="session-details">
                    <!-- 当前投票会话详情 -->
                </div>
                <div id="voteOptions" class="vote-options">
                    <!-- 投票选项 -->
                </div>
                <button id="submitVote" class="btn btn-primary">提交投票</button>
            </section>

            <!-- 结果展示区域 -->
            <section class="results-section">
                <h2>📊 投票结果</h2>
                <div id="resultsContainer" class="results-container">
                    <!-- 投票结果展示 -->
                </div>
                <button id="refreshResults" class="btn btn-info">刷新结果</button>
            </section>
        </main>

        <!-- 状态信息 -->
        <div class="status-bar">
            <div id="statusMessage" class="status-message">
                等待连接钱包...
            </div>
            <div id="transactionStatus" class="transaction-status">
                <!-- 交易状态 -->
            </div>
        </div>

        <!-- 技术信息 -->
        <div class="tech-info">
            <h3>🛠️ 技术特性</h3>
            <div class="tech-features">
                <div class="feature">
                    <h4>🔐 全同态加密</h4>
                    <p>使用 FHEVM 技术确保投票隐私</p>
                </div>
                <div class="feature">
                    <h4>🌐 去中心化</h4>
                    <p>运行在区块链上，无需信任中心化服务</p>
                </div>
                <div class="feature">
                    <h4>🛡️ 防篡改</h4>
                    <p>智能合约保证投票过程的透明和公正</p>
                </div>
                <div class="feature">
                    <h4>🚀 实时统计</h4>
                    <p>在保护隐私的同时提供实时投票统计</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 模态框 -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="modalTitle">标题</h2>
            <div id="modalBody">内容</div>
            <div class="modal-actions">
                <button id="modalConfirm" class="btn btn-primary">确认</button>
                <button id="modalCancel" class="btn btn-secondary">取消</button>
            </div>
        </div>
    </div>

    <!-- 加载动画 -->
    <div id="loading" class="loading">
        <div class="spinner"></div>
        <p>处理中，请稍候...</p>
    </div>

    <!-- 脚本引用 -->
    <script src="https://cdn.jsdelivr.net/npm/ethers@6.8.0/dist/ethers.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fhevmjs@0.4.0/bundle/index.js"></script>
    <script src="frontend/contract-config.js"></script>
    <script src="frontend/script.js"></script>
</body>
</html> 